
include "install_ubuntu.testo"

macro enter_sudo(host_name, login, password) {
	type "sudo su"; press Enter;
	wait "[sudo] password for ${login}"; type "${password}"; press Enter
	wait "root@${host_name}"
}

macro install_guest_additions_ubuntu_server(host_name, login, password) {
	enter_sudo("${host_name}", "${login}", "${password}")
	plug dvd "/opt/iso/testo-guest-additions.iso"; sleep 5s
	type "mount /dev/cdrom /media"; press Enter
	wait "mounting read-only"; type "dpkg -i /media/*.deb"; press Enter;
	wait "Setting up testo-guest-additions"
	type "umount /media"; press Enter;
	sleep 2s
	unplug dvd
}

test install_ubuntu_server_guest_additions: install_ubuntu_server {
	my_ubuntu_server {
		sleep 20s
		press Enter*20
		install_guest_additions_ubuntu_server("ubuntu", "user", "1111")
	}
}