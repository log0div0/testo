
include "centos.testo"


[no_snapshots: true]
test centos_backend_qemu_simple_test_spec: centos_install_testo_cpu {
	centos {
		copyto "${TEST_ASSETS_DIR}/test_spec_exclude/test_spec_exclude.testo" "/opt/scripts/test_spec_exclude.testo"

		exec bash """
			set +o pipefail
			set +e
			output=$(testo run /opt/scripts/test_spec_exclude.testo --test_spec test1*)
			[[ $output == *"Running test test121"* ]]
			[[ $output == *"Running test test141"* ]]
			[[ $output != *"Running test test2"* ]]
			[[ $output != *"Running test test3"* ]]
		""" timeout 30m
	}
}

[no_snapshots: true]
test centos_backend_qemu_wildcard_test_spec: centos_install_testo_cpu {
	centos {
		copyto "${TEST_ASSETS_DIR}/test_spec_exclude/test_spec_exclude.testo" "/opt/scripts/test_spec_exclude.testo"

		exec bash """
			set +o pipefail
			set +e
			output=$(testo run /opt/scripts/test_spec_exclude.testo --test_spec \\*test1*)
			[[ $output == *"Running test test121"* ]]
			[[ $output == *"Running test test141"* ]]
			[[ $output != *"Running test test2"* ]]
			[[ $output != *"Running test test22"* ]]
			[[ $output != *"Running test test3"* ]]
		""" timeout 30m
	}
}

[no_snapshots: true]
test centos_backend_qemu_multiple_test_spec: centos_install_testo_cpu {
	centos {
		copyto "${TEST_ASSETS_DIR}/test_spec_exclude/test_spec_exclude.testo" "/opt/scripts/test_spec_exclude.testo"

		exec bash """
			set +o pipefail
			set +e
			output=$(testo run /opt/scripts/test_spec_exclude.testo --test_spec test1* --test_spec test2)
			[[ $output == *"Running test test121"* ]]
			[[ $output == *"Running test test141"* ]]
			[[ $output == *"Running test test2"* ]]
			[[ $output != *"Running test test3"* ]]
			[[ $output != *"Running test test22"* ]]
		""" timeout 30m
	}
}

[no_snapshots: true]
test centos_backend_qemu_simple_exclude: centos_install_testo_cpu {
	centos {
		copyto "${TEST_ASSETS_DIR}/test_spec_exclude/test_spec_exclude.testo" "/opt/scripts/test_spec_exclude.testo"

		exec bash """
			set +o pipefail
			set +e
			output=$(testo run /opt/scripts/test_spec_exclude.testo --exclude test2)
			[[ $output == *"Running test test121"* ]]
			[[ $output == *"Running test test141"* ]]
			[[ $output == *"Running test test22"* ]]
			[[ $output == *"Running test test3"* ]]
			[[ $output != *"Running test test2"* ]]
		""" timeout 30m
	}
}

[no_snapshots: true]
test centos_backend_qemu_multiple_exclude: centos_install_testo_cpu {
	centos {
		copyto "${TEST_ASSETS_DIR}/test_spec_exclude/test_spec_exclude.testo" "/opt/scripts/test_spec_exclude.testo"

		exec bash """
			set +o pipefail
			set +e
			output=$(testo run /opt/scripts/test_spec_exclude.testo --exclude test2 --exclude test1*)
			[[ $output != *"Running test test121"* ]]
			[[ $output != *"Running test test141"* ]]
			[[ $output == *"Running test test22"* ]]
			[[ $output == *"Running test test3"* ]]
			[[ $output != *"Running test test2"* ]]
		""" timeout 30m
	}
}

[no_snapshots: true]
test centos_backend_qemu_test_spec_exclude_pipeline1: centos_install_testo_cpu {
	centos {
		copyto "${TEST_ASSETS_DIR}/test_spec_exclude/test_spec_exclude.testo" "/opt/scripts/test_spec_exclude.testo"

		exec bash """
			set +o pipefail
			set +e
			output=$(testo run /opt/scripts/test_spec_exclude.testo --test_spec test*2* --exclude test2*)
			[[ $output = *"Running test test121"* ]]
			[[ $output != *"Running test test141"* ]]
			[[ $output != *"Running test test22"* ]]
			[[ $output != *"Running test test3"* ]]
			[[ $output != *"Running test test2"* ]]
		""" timeout 30m
	}
}

[no_snapshots: true]
test centos_backend_qemu_test_spec_exclude_pipeline2: centos_install_testo_cpu {
	centos {
		copyto "${TEST_ASSETS_DIR}/test_spec_exclude/test_spec_exclude.testo" "/opt/scripts/test_spec_exclude.testo"

		exec bash """
			set +o pipefail
			set +e
			output=$(testo run /opt/scripts/test_spec_exclude.testo --exclude test2* --test_spec test*2*)
			[[ $output != *"Running test test121"* ]]
			[[ $output != *"Running test test141"* ]]
			[[ $output != *"Running test test22"* ]]
			[[ $output != *"Running test test3"* ]]
			[[ $output != *"Running test test2"* ]]
		""" timeout 30m
	}
}

