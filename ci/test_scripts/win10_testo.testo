
include "win10.testo"

test win10_install_guest_additions: win10_installation_part_2 {
	win10 {
		mouse click "Поиск видеодрайвера"
		wait "Центр обновления"; press LeftAlt+F4
		wait !"Центр обновления"
		plug dvd "${ISO_DIR}/testo-guest-additions.iso"
		sleep 5s
		mouse click "CD-дисковод"
		sleep 5s
		mouse click "Выполнить autorun"
		wait "Testo Guest Additions"; press Enter
		mouse click "I accept the terms";
		mouse click "Next"
		wait "Destination Folder"; press Enter
		wait "Ready to install"; press Enter
		wait "Разрешить этому приложению"
		mouse click "Да".from_bottom(0)
		wait "Установить программное обеспечение для данного устройства?";
		mouse click "Установить".from_top(1)
		wait "Click the Finish button"; press Enter
		wait !"Click the Finish button"
		exec cmd "echo hello world"
		unplug dvd
		sleep 5s
	}
}

[no_snapshots: true]
test win10_install_testo_cpu: win10_install_guest_additions {
	win10 {
		copyto "${OUT_DIR}/testo-cpu-x64.msi" "C:\\Users\\user\\Desktop\\testo.msi"
		mouse dclick "testo"
		wait "Welcome to the Testo Setup"; press Enter
		mouse click "I accept the terms";
		mouse click "Next"
		wait "Destination Folder"; press Enter
		wait "Ready to install"; press Enter
		wait "Разрешить этому приложению"
		mouse click "Да".from_bottom(0)
		wait "Click the Finish button"; press Enter
		wait !"Click the Finish button"

		exec cmd "testo version"
	}
}

[no_snapshots: true]
test win10_install_testo_gpu: win10_install_guest_additions {
	win10 {
		copyto "${OUT_DIR}/testo-gpu-x64.msi" "C:\\Users\\user\\Desktop\\testo.msi"
		mouse dclick "testo"
		wait "Welcome to the Testo Setup"; press Enter
		mouse click "I accept the terms";
		mouse click "Next"
		wait "Destination Folder"; press Enter
		wait "Ready to install"; press Enter
		wait "Разрешить этому приложению"
		mouse click "Да".from_bottom(0)
		wait "Click the Finish button"; press Enter
		wait !"Click the Finish button"

		exec cmd "testo version"
	}
}
