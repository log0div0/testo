..  SPDX-License-Identifier: BSD-3-Clause
    Copyright(c) 2010-2014 Intel Corporation.

.. _network:

network
=======

Для объявления виртуальных сетей используется директива ``network``. Формат директивы выглядит следующим образом:

.. code-block:: none

	network <name> {
		<attr1: <value1>
		<attr2: <value1>
		<attr3: <value1>
		...
	}

.. note::
	Объявление виртуальной сети само по себе не приведет к ее созданию. Реальное создание произойдет при запуске теста, в котором учавствует эта сеть.

Объявление виртуальных сетей имеет формат, сходный с :ref:`объявлением виртуальных машин <machine>`, но список атрибутов здесь другой:

	*  ``mode`` - режим работы виртуальной сети. Значение атрибута должно быть **строкой**. В настоящий момент поддерживаются следующие значения:

		* ``nat`` - адаптер подключен к основной сети хостовой машины через маршрутизатор и может иметь доступ к внешней сети (например, к Интернету)
		* ``internal`` - адаптер подключен к внутренней изолированной сети гипервизора.

	*  ``persistent`` - Должна ли создаваемая сеть существовать после перезагрузки хостовой машины. Необязательный атрибут. Значение атрибута должно быть **логической константой**.
	*  ``autostart`` - Должна ли создаваемая сеть автоматически запускаться при создании. Необязательный атрибут. Значение атрибута должно быть **логической константой**. Значение по-умолчанию: ``true``.

Ниже представлен пример объявления виртуальной сети:

.. code-block:: none

	network example_network {
		mode: "nat"
		persistent: false
	}


.. note::
	При создании сети в реиме nat ей назначается диапазон 192.168.156.1/24. Если сеть с таким диапазоном уже занята, то будет автоматически выполнен поиск первой "незанятого" диапазона адресов (192.168.157.0/24, 192.168.158.0/24 и т.д.) вплоть до 192.168.254.0/24. Если все диапазоны будут заняты, программа завершится с ошибкой.