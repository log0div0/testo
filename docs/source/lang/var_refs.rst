..  SPDX-License-Identifier: BSD-3-Clause
    Copyright(c) 2010-2014 Intel Corporation.

.. _var_refs:

Обращение к переменным
======================

В языке Testo существует особенность обобщать процесс тестирования с помощью переменных. На текущий момент переменные могут принимать только текстовые значения. Существует четыре способа задания переменных:

	- Через параметр (глобальную константу) в тексте файла .testo
	- Через параметр (глобальную константу), переданный в качестве аргумента командой строки
	- Через счетчик в цикле ``for``
	- В качестве параметров в макросах

Обращаться к переменным можно в следующих местах скриптов:

	- в составе :ref:`действий <actions>`, которые в качестве аргумента принимают строки
	- в конфигурациях виртуальной машины или виртуального флеш-накопителя (в тех атрибутах, которые могут принимать строковые значения). Обращение к переменной во всех случаях выглядит одинаково:

.. code-block:: none

	"${VAR_REF}"

Где ``VAR_REF`` - это идентификатор с именем переменной

Обращаться к переменной можно прямо внутри строки, не прерывая ее:

.. code-block:: none

	"Hello ${VAR_REF}"

Обращаться к переменным можно и в многострочных строках и в select-выражениях

.. code-block:: none

	"""Hello
		${VAR_REF}
	"""

	`select * from textlines
		where text = "Menu entry"
			and foreground = "${foreground_colour}"
			and background = "gray"`

Экранирование обращения к переменным
++++++++++++++++++++++++++++++++++++

Для экранирования сочетания символов ``${`` необходимо добавить еще один знак доллара в начале: ``$${``.


Порядок разрешения значения переменных
++++++++++++++++++++++++++++++++++++++

При обращении к переменной ее значение вычисляется по следующему алгоритму, причем если на каком-то шаге находится значение переменной, то алгоритм прекращается:

	1) Если обращение к переменной происходит внутри цикла ``for``, то проверяется, является ли переменная счетчиком цикла
	2) Если обращение к переменной происходит внутри макроса, то проверяется, является ли переменная параметром макроса
	3) Если на предыдущих этапах не получилось вычислить значение, то проверяется, является ли переменная параметром (глобальной константой)
	5) Возвращается пустая строка
